services:
  - type: web
    name: vending-machine-app
    env: docker
    buildCommand: |
      # Build frontend
      cd VendingMachineApp.Client
      npm install
      npm run build:prod
      # Copy frontend build to backend wwwroot
      mkdir -p ../Vending-Machine-App/Vending-Machine-App/wwwroot
      cp -r dist/vending-machine-app.client/* ../Vending-Machine-App/Vending-Machine-App/wwwroot/
      # Build backend
      cd ../Vending-Machine-App
      dotnet publish -c Release -o out
    startCommand: dotnet Vending-Machine-App.dll
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__DefaultConnection
        value: your_database_connection_string